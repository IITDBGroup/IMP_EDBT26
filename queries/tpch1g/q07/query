select supp_nation, cust_nation, l_year, sum(volume)::float as revenue from (select name1 as supp_nation, name2 as cust_nation, date_part('year', l_shipdate)::text as l_year, (l_extendedprice * (1 - l_discount))::float as volume from ((select s_suppkey, s_nationkey from supplier) supplier join (select l_extendedprice, l_discount, l_shipdate,l_orderkey, l_suppkey from lineitem where l_shipdate > '1995-01-01' and l_shipdate < '1996-12-31') lineitem on(s_suppkey = l_suppkey) join (select o_orderkey, o_custkey from orders) orders on (o_orderkey = l_orderkey) join (select c_custkey, c_nationkey from customer) custoner on (c_custkey = o_custkey) join (select n_name as name1, n_nationkey as nk1 from nation) n1 on (s_nationkey = nk1) join (select n_name as name2, n_nationkey as nk2 from nation) n2 on (c_nationkey = nk2) ) joinss where (name1 = 'GERMANY' and name2 = 'FRANCE') or (name1 = 'FRANCE' and name2 = 'GERMANY')) shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year
