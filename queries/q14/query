SELECT 100.00 * sum(CASE WHEN p_type LIKE 'PROMO%' THEN (l_extendedprice * (1 - l_discount))::float ELSE 0 END)::float / sum((l_extendedprice * (1 - l_discount))::float)::float AS promo_revenue from ((select l_partkey, l_extendedprice, l_discount from lineitem where l_shipdate >= to_date('1995-09-01', 'YYYY-MM-DD') and l_shipdate < to_date('1995-10-01', 'YYYY-MM-DD')) lineitem join (select p_partkey, p_type from part ) part on (l_partkey = p_partkey)) tmptbl
