select c_custkey, c_name, sum((l_extendedprice * (1 - l_discount))::float)::float as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from ((select c_name, c_acctbal, c_address, c_phone, c_comment, c_custkey, c_nationkey from customer) customer join (select o_custkey, o_orderkey from orders where o_orderdate >= to_date('1994-12-01', 'YYYY-MM-DD') and o_orderdate < to_date('1995-03-01', 'YYYY-MM-DD')) orders on (c_custkey = o_custkey) join (select l_extendedprice, l_discount, l_orderkey from lineitem where l_returnflag = 'R') lineitem on (l_orderkey = o_orderkey) join (select n_name, n_nationkey from nation) nation on (c_nationkey = n_nationkey)) joins group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue limit 20
