select l_shipmode, sum(CASE WHEN o_orderpriORity = '1-URGENT' OR o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, sum(CASE WHEN o_orderpriORity <> '1-URGENT' AND o_orderpriORity <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count from ((select o_orderkey, o_orderpriority from orders) orders join (select l_orderkey, l_shipmode from lineitem where (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate > to_date('1994-01-01', 'YYYY-MM-DD') and l_receiptdate < to_date('1995-01-01', 'YYYY-MM-DD')) lineitem on (l_orderkey = o_orderkey)) shipping group by l_shipmode order by l_shipmode
