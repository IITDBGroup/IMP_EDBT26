select n_name, sum((l_extendedprice * (1 - l_discount))::float)::float as revenue from ((select c_custkey, c_nationkey from customer) customer join (select o_custkey, o_orderkey from orders where o_orderdate >= TO_DATE('1994-01-01', 'YYYY-MM-DD') AND o_orderdate < TO_DATE('1995-01-01','YYYY-MM-DD')) orders on (c_custkey = o_custkey) join (select l_extendedprice, l_discount, l_orderkey, l_suppkey from lineitem) lineitem on (l_orderkey = o_orderkey) join (select s_nationkey, s_suppkey from supplier) supplier on (l_suppkey = s_suppkey) join (select n_name, n_nationkey, n_regionkey from nation) nation on (n_nationkey = s_nationkey and n_nationkey = c_nationkey) join (select r_regionkey from region where r_name = 'ASIA') region on (r_regionkey = n_regionkey)) group by n_name order by revenue desc
