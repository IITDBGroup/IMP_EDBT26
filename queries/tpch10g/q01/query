select l_returnflag, l_linestatus, sum(l_quantity)::float as sum_qty, sum(l_extendedprice)::float as sum_base_price, sum((l_extendedprice * (1 - l_discount))::float)::float as sum_disc_price, sum((l_extendedprice * (1 - l_discount) * (1 + l_tax))::float)::float as sum_charge, avg(l_quantity)::float as avg_qty, avg(l_extendedprice)::float as avg_price, avg(l_discount)::float as avg_disc, count(*)::bigint as count_order from lineitem where l_shipdate <= to_date( '1998-12-01', 'YYYY-MM-DD') group by l_returnflag, l_linestatus
